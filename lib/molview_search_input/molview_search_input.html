<dom-module id="molview-search-input">
  <template>
    <style>
      :host {
        position: relative;

        --input-padding: 20px;
        --input-height: 38px;
        --input-width: 500px;
        --popup-speed: .3s;
      }

      paper-input {
        --paper-input-container-color: var(--paper-red-a100);
        --paper-input-container-focus-color: #000;
      }

      #bar {
        position: relative;
        height: var(--input-height);
        overflow: hidden;
        align-items: center;

        color: var(--molview-white);
        background-color: var(--paper-red-a100);
        border-radius: var(--molview-radius);

        /* Fix for ripple overflow at border-radius during transition */
        -webkit-backface-visibility: hidden;
        -webkit-transform: translate3d(0, 0, 0);

        /* Change border-radius backt to normal after popup is collapsed */
        transition: border-radius;
        transition-delay: var(--popup-speed);
      }

      #bar.focussed {
        color: var(--molview-black);
        border-radius: var(--molview-radius) var(--molview-radius) 0 0;
        transition-delay: 0s;
      }

      :host:not([mini-toolbar]) #bar {
        max-width: var(--input-width);
      }

      /* Left button in .mini-toolbar */

      :host:not([mini-toolbar]) #left-button {
        display: none;
      }

      #drawer-toggle, #arrow-back {
        margin: 0 5px;
      }

      #arrow-back {
        padding: 8px;
      }

      #left-button.visible > #drawer-toggle {
        display: none;
      }

      #left-button:not(.visible) > #arrow-back {
        display: none;
      }

      /* Search icon (not displayed in .mini-toolbar) */

      #search-icon {
        position: absolute;
        top: calc((var(--input-height) - 24px) / 2);
        left: var(--input-padding);
        pointer-events: none;
      }

      :host[mini-toolbar] #search-icon {
        display: none;
      }

      /* Text input styles */

      #input {
        z-index: 0;
        height: 100%;
        padding: 0 var(--input-padding) 0 60px;
        flex: 1;

        border: none;
        outline: none;
        background: none;
        color: var(--molview-white);

        /* For some reason fonts have to be explicitly defined for inputs */
        font-family: 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;
      }

      :host[mini-toolbar] #input {
        padding: 0 var(--input-padding) 0 0;
      }

      #input:focus {
        color: var(--molview-black);
      }

      /* Cross-browser placeholder color */
      #input::-webkit-input-placeholder {
        color: var(--paper-red-50); } /* WebKit, Blink, Edge */
      #input:-moz-placeholder {
        color: var(--paper-red-50); } /* Mozilla Firefox 4 to 18 */
      #input::-moz-placeholder {
        color: var(--paper-red-50); } /* Mozilla Firefox 19+ */
      #input:-ms-input-placeholder {
        color: var(--paper-red-50); } /* Internet Explorer 10-11 */

      #input:focus::-webkit-input-placeholder {
        color: var(--molview-black); } /* WebKit, Blink, Edge */
      #input:focus:-moz-placeholder {
        color: var(--molview-black); } /* Mozilla Firefox 4 to 18 */
      #input:focus::-moz-placeholder {
        color: var(--molview-black); } /* Mozilla Firefox 19+ */
      #input:focus:-ms-input-placeholder {
        color: var(--molview-black); } /* Internet Explorer 10-11 */

      /* Input focus ripple effect */

      #ripple {
        position: absolute;
        pointer-events: none;
        top: 0;
        left: calc(var(--input-padding) - (var(--input-height) / 2 - 12px));
        width: var(--input-height);
        height: var(--input-height);

        background-color: rgba(255, 255, 255, 0);
        border-radius: 50%;
        transform: scale(1);
        transition: background-color .3s ease-in, transform .3s ease-out;
      }

      #ripple.down {
        background-color: rgba(255, 255, 255, 1);
        transform: scale(30);
        transition: opacity .1s ease-out, transform .3s ease-in;
      }

      /* Search popup */

      #popup-wrapper {
        z-index: 1;
        position: fixed;
        top: calc(32px + var(--input-height) / 2);
        bottom: 0;
      }

      #popup-wrapper:not(.visible) {
        pointer-events: none;
      }

      #popup {
        position: relative;
        top: 0;
        height: 0;
        transition: var(--popup-speed) height;
        overflow: hidden;

        background: var(--molview-white);
        border-radius: 0 0 var(--molview-radius) var(--molview-radius);
      }

      #popup-list {
        display: table;
        width: 100%;
        margin: 0;
        padding: 10px 0;
        color: var(--molview-black);
      }

      #popup-list > li {
        padding: 10px 20px 10px 60px;
        list-style: none;
        cursor: pointer;
      }

      :host[mini-toolbar] #popup-list > li {
        padding-left: 50px;
      }

      .list-item-tag {
        padding: 6px;
        float: right;

        font-size: 8pt;
        line-height: 1;
        text-transform: uppercase;
        color: var(--molview-white);
        border-radius: var(--molview-radius);
        box-shadow: 0px 2px 2px -1px rgba(0, 0, 0, 0.5);
        /* text-shadow: 0 0 1px rgba(0, 0, 0, 0.3); */
      }

      .list-item-tag.database {
        background: var(--paper-brown-900);
      }
    </style>

    <paper-material id="bar" class="layout horizontal" elevation="1">
      <div id="ripple"></div>
      <div id="left-button">
        <paper-icon-button
            id="drawer-toggle"
            icon="menu"></paper-icon-button>
        <iron-icon
            id="arrow-back"
            icon="arrow-back"></iron-icon>
      </div>
      <iron-icon
          id="search-icon"
          icon="search"></iron-icon>
      <input
          id="input"
          placeholder="Type to search..."
          autocomplete="off"
          spellcheck="false"></input>
    </paper-material>
    <div id="popup-wrapper">
      <paper-material id="popup" class="layout horizontal" elevation="3">
        <ol id="popup-list">
          <li>
            PubChem
            <span class="list-item-tag database">Database</span>
          </li>
          <li>
            ChemSpider
            <span class="list-item-tag database">Database</span>
          </li>
          <li>
            ChEMBL
            <span class="list-item-tag database">Database</span>
          </li>
          <li>
            PDB
            <span class="list-item-tag database">Database</span>
          </li>
          <li>
            COD
            <span class="list-item-tag database">Database</span>
          </li>
        </ol>
      </paper-material>
    </div>
  </template>
</dom-module>
