<dom-module id="molview-search-input">
  <template>
    <style>
      :host {
        position: relative;

        --input-padding: 20px;
        --input-height: 38px;
        --input-width: 500px;
        --popup-margin: 30px;
      }

      paper-input {
        --paper-input-container-color: var(--paper-red-a100);
        --paper-input-container-focus-color: #000;
      }

      #bar {
        position: relative;
        max-width: var(--input-width);
        height: var(--input-height);
        overflow: hidden;
        align-items: center;

        color: var(--molview-white);
        background-color: var(--paper-red-a100);
        border-radius: var(--molview-radius);

        /* Fix for ripple overflow at border-radius during transition */
        -webkit-backface-visibility: hidden;
        -webkit-transform: translate3d(0, 0, 0);
      }

      #bar.focussed {
        color: var(--molview-black);
      }

      /* Left button in .mini-toolbar */

      #left-button {
        display: none;
      }

      :host[mini-toolbar] #left-button {
        display: inherit;
      }

      #drawer-toggle, #arrow-back {
        margin: 0 5px;
      }

      #arrow-back {
        display: none;
        padding: 8px;
      }

      #left-button.focussed > #drawer-toggle {
        display: none;
      }

      #left-button.focussed > #arrow-back {
        display: inherit;
      }

      /* Search icon (not displayed in .mini-toolbar) */

      #search-icon {
        position: absolute;
        top: calc((var(--input-height) - 24px) / 2);
        left: var(--input-padding);
        pointer-events: none;
      }

      :host[mini-toolbar] #search-icon {
        display: none;
      }

      /* Text input styles */

      #input {
        z-index: 0;
        height: 100%;
        padding: 0 var(--input-padding) 0 60px;
        flex: 1;

        border: none;
        outline: none;
        background: none;
        color: var(--molview-white);

        /* For some reason fonts have to be explicitly defined for inputs */
        font-family: 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;
      }

      :host[mini-toolbar] #input {
        padding: 0 var(--input-padding) 0 0;
      }

      #input:focus {
        color: var(--molview-black);
      }

      /* Cross-browser placeholder color */
      #input::-webkit-input-placeholder {
        color: var(--paper-red-50); } /* WebKit, Blink, Edge */
      #input:-moz-placeholder {
        color: var(--paper-red-50); } /* Mozilla Firefox 4 to 18 */
      #input::-moz-placeholder {
        color: var(--paper-red-50); } /* Mozilla Firefox 19+ */
      #input:-ms-input-placeholder {
        color: var(--paper-red-50); } /* Internet Explorer 10-11 */

      #input:focus::-webkit-input-placeholder {
        color: var(--molview-black); } /* WebKit, Blink, Edge */
      #input:focus:-moz-placeholder {
        color: var(--molview-black); } /* Mozilla Firefox 4 to 18 */
      #input:focus::-moz-placeholder {
        color: var(--molview-black); } /* Mozilla Firefox 19+ */
      #input:focus:-ms-input-placeholder {
        color: var(--molview-black); } /* Internet Explorer 10-11 */

      /* Input focus ripple effect */

      #ripple {
        position: absolute;
        pointer-events: none;
        top: 0;
        left: calc(var(--input-padding) - (var(--input-height) / 2 - 12px));
        width: var(--input-height);
        height: var(--input-height);

        opacity: 0;
        background: white;
        border-radius: 50%;
        transform: scale(1);
        transition: opacity .3s ease-in, transform .3s ease-out;
      }

      #ripple.down {
        opacity: 1;
        transform: scale(30);
        transition: opacity .1s ease-out, transform .3s ease-in;
      }

      /* Search popup */

      #popup-wrapper {
        position: absolute;
        margin-top: calc((64px - var(--input-height)) / 2);
        left: calc(-1 * var(--popup-margin));
        right: calc(-1 * var(--popup-margin));
        overflow: hidden;
      }

      #popup {
        /* Under development */
        display: none;

        z-index: 1;
        top: 0;
        margin: 0 var(--popup-margin) var(--popup-margin) var(--popup-margin);
        max-width: var(--input-width);
        background: var(--molview-white);

        border-radius: 0 0 var(--molview-radius) var(--molview-radius);

        height: 300px;
      }
    </style>

    <paper-material id="bar" class="layout horizontal" elevation="1">
      <div id="ripple"></div>
      <div id="left-button">
        <paper-icon-button
            id="drawer-toggle"
            icon="menu"></paper-icon-button>
        <iron-icon
            id="arrow-back"
            icon="arrow-back"></iron-icon>
      </div>
      <iron-icon
          id="search-icon"
          icon="search"></iron-icon>
      <input
          id="input"
          placeholder="Type to search..."
          autocomplete="off"
          spellcheck="false"></input>
    </paper-material>
    <div id="popup-wrapper">
      <paper-material id="popup" class="layout horizontal" elevation="3">
      </paper-material>
    </div>
  </template>
</dom-module>
